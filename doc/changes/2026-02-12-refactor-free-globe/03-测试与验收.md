# 03 测试与验收

## 1. 测试范围

- Globe 模式跨越南北极连续旋转；
- 交互一致性：鼠标拖拽、触控旋转、惯性衰减；
- API 行为：`jumpTo/easeTo/flyTo` 跨极路径稳定性；
- 向后兼容：Mercator 与 legacy 模式行为不变；
- 性能稳定性：帧率、输入响应、CPU 占用。

## 2. 复现步骤（Bug 场景可填）

历史问题复现（基线）：

1. 打开 Globe 模式地图；
2. 将中心接近北极（或南极）；
3. 持续拖拽旋转尝试越过极点；
4. 观察到中心/朝向出现卡边或突变。

修复后预期：

- 可连续跨越极点，镜头运动平滑；
- 无突然反向、无明显跳变；
- 事件序列与动画时序符合规范。

## 3. 用例设计

### 3.1 功能用例

- C-FUNC-01：北极跨越连续旋转（正向）；
- C-FUNC-02：南极跨越连续旋转（反向）；
- C-FUNC-03：跨极后继续旋转 360°，无跳变；
- C-FUNC-04：`easeTo` 跨极动画连续；
- C-FUNC-05：`flyTo` 跨极动画连续；
- C-FUNC-06：legacy 模式下行为与当前版本一致。

### 3.2 回归用例

- C-REG-01：非 Globe 投影交互不受影响；
- C-REG-02：双指缩放 + 旋转组合手势无退化；
- C-REG-03：Marker/Popup 在极区位置更新正常；
- C-REG-04：地形开启/关闭下跨极行为一致。

### 3.3 边界与异常用例

- C-BND-01：极点附近高频来回拖拽；
- C-BND-02：跨极中断（失焦、窗口切换）后恢复；
- C-BND-03：高缩放 Globe/Mercator 过渡点跨极操作；
- C-BND-04：低性能设备持续旋转 60s 稳定性。

## 4. 执行记录

| 用例ID | 描述 | 结果 | 备注 |
| --- | --- | --- | --- |
| C-FUNC-01 | 北极跨越连续旋转 | pending | 实现后执行 |
| C-FUNC-02 | 南极跨越连续旋转 | pending | 实现后执行 |
| C-FUNC-04 | `easeTo` 跨极动画连续 | pending | 实现后执行 |
| C-REG-01 | Mercator 回归验证 | pending | 实现后执行 |
| C-BND-01 | 极区高频拖拽稳定性 | pending | 实现后执行 |

## 5. 性能验证（如适用）

目标阈值（相对 baseline）：

- 交互主线程单帧处理耗时：P95 不超过 +2ms；
- Globe 交互帧率：P50 不低于 55 FPS（测试机基线环境）；
- 旋转连续 60s：无内存异常增长（趋势平稳）。

对比维度：

- legacy vs free 两种模式；
- 北极场景、南极场景、赤道场景；
- 有地形/无地形。

## 6. 验收结论

当前状态：待实现，未验收。

验收通过标准：

- 核心功能用例全部通过；
- 回归用例无 P0/P1 问题；
- 性能指标达标；
- 回滚预案演练通过。

## 7. 遗留问题

- 待确认是否对外公开 `globepolecross` 事件；
- 待确认 free 模式默认开启策略（版本/租户/配置中心）；
- 待评估极区文字朝向在个别 pitch 下的视觉一致性。
